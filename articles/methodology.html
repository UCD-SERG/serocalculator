<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="serocalculator">
<title>Serocalculator package methodology • serocalculator</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Serocalculator package methodology">
<meta property="og:description" content="serocalculator">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">serocalculator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/cover.html">R Package - serocalculator</a>
    <a class="dropdown-item" href="../articles/example-analysis.html">example-analysis</a>
    <a class="dropdown-item" href="../articles/installation.html">Serocalculator package installation manual</a>
    <a class="dropdown-item" href="../articles/methodology.html">Serocalculator package methodology</a>
    <a class="dropdown-item" href="../articles/simulation.html">simulation</a>
    <a class="dropdown-item" href="../articles/tutorial.html">Serocalculator package tutorial</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/UCD-SERG/serocalculator/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Serocalculator package methodology</h1>
                        <h4 data-toc-skip class="author">European Centre
for Disease Prevention and Control (ECDC)</h4>
            
            <h4 data-toc-skip class="date">2023-10-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UCD-SERG/serocalculator/blob/HEAD/vignettes/methodology.Rmd" class="external-link"><code>vignettes/methodology.Rmd</code></a></small>
      <div class="d-none name"><code>methodology.Rmd</code></div>
    </div>

    
    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script><div style="page-break-after: always;"></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The revised seroincidence calculator package provides three
refinements to the method for calculating seroincidence published
earlier <span class="citation">(Teunis et al. 2012)</span> and
implemented in R package <strong>seroincidence</strong>, versions 1.x:
(1) inclusion of infection episode with rising antibody levels, (2)
non–exponential decay of serum antibodies after infection, and (3)
age–dependent correction for subjects who have never seroconverted. It
is important to note that, although the implemented methods use a
specific parametric model, as proposed in <span class="citation">(de
Graaf et al. 2014)</span> and augmented in <span class="citation">(Teunis et al. 2016)</span>, the methods used to
calculate the likelihood function allow seroresponses of arbitrary
shape.</p>
</div>
<div class="section level2">
<h2 id="a-simple-model-for-the-seroresponse">1. A simple model for the seroresponse<a class="anchor" aria-label="anchor" href="#a-simple-model-for-the-seroresponse"></a>
</h2>
<p>The current version of the serocalculator package uses the model of
<span class="citation">(Teunis et al. 2016)</span> for the shape of the
seroresponse: <span class="math display">\[
\begin{array}{l@{\qquad}l}
\text{Infection/colonization episode} &amp; \text{Waning immunity
episode}\\
b^{\prime}(t) = \mu_{0}b(t) - cy(t) &amp; b(t) = 0 \\
y^{\prime}(t) = \mu y(t) &amp; y^{\prime}(t) = -\nu y(t)^r \\
\end{array}
\]</span></p>
<p>With baseline antibody concentration <span class="math inline">\(y(0)
= y_{0}\)</span> and initial pathogen concentration <span class="math inline">\(b(0) = b_{0}\)</span>. The serum antibody response
<span class="math inline">\(y(t)\)</span> can be written as <span class="math display">\[
y(t) = y_{+}(t) + y_{-}(t)
\]</span> where <span class="math display">\[\begin{align*}
y_{+}(t) &amp; = y_{0}\text{e}^{\mu t}[0\le t &lt;t_{1}]\\
y_{-}(t) &amp; =
y_{1}\left(1+(r-1)y_{1}^{r-1}\nu(t-t_{1})\right)^{-\frac{1}{r-1}}[t_{1}\le
t &lt; \infty]
\end{align*}\]</span> Since the peak level is <span class="math inline">\(y_{1} = y_{0}\text{e}^{\mu t_{1}}\)</span> the
(unobservable) growth rate <span class="math inline">\(\mu\)</span> can
be written as <span class="math display">\[\mu =
\frac{1}{t_{1}}\log\left(\frac{y_{1}}{y_{0}}\right)\]</span></p>
<p>Antibody decay is different from exponential (log–linear) decay. When
the shape parameter <span class="math inline">\(r &gt; 1\)</span>, log
concentrations decrease rapidly after infection has terminated, but
decay then slows down and low antibody concentrations are maintained for
a long period. When <span class="math inline">\(r\)</span> approaches 1,
exponential decay is restored.</p>
</div>
<div class="section level2">
<h2 id="backward-recurrence-time">2. Backward recurrence time<a class="anchor" aria-label="anchor" href="#backward-recurrence-time"></a>
</h2>
<p>Considering the (fundamental) uniform distribution <span class="math inline">\(u_{f}\)</span> of sampling within a given
interval, the interval length distribution <span class="math inline">\(p(\Delta t)\)</span> and the distribution of
(cross–sectionally) sampled interval length <span class="citation">(Teunis et al. 2012)</span> <span class="math display">\[
q(\Delta t) = \frac{p(\Delta t)\cdot\Delta t}{\overline{\Delta t_{p}}}
\]</span> the joint distribution of backward recurrence time and
cross–sectional interval length is the product <span class="math inline">\(u_{f}\cdot q\)</span> because these probabilities
are independent.</p>
<p>The distribution of backward recurrence time is the marginal
distribution <span class="math display">\[\begin{align*}
u(\tau) &amp; = \int_{\Delta t=0}^{\infty} u_{f}(\tau;\Delta t)\cdot
q(\Delta t)\text{d}\Delta t\\
        &amp; = \int_{0}^{\infty}\frac{[0\le\tau\le\Delta t]}{\Delta
t}\cdot \frac{p(\Delta t)\cdot
            \Delta t}{\overline{\Delta t_{p}}}\text{d}\Delta t\\
        &amp; = \frac{1}{\overline{\Delta
t_{p}}}\int_{\tau}^{\infty}p(\Delta t)\text{d}\Delta t
\end{align*}\]</span></p>
</div>
<div class="section level2">
<h2 id="incidence-of-seroconversions">3. Incidence of seroconversions<a class="anchor" aria-label="anchor" href="#incidence-of-seroconversions"></a>
</h2>
<p>To calculate the incidence of seroconversions, as in <span class="citation">(Teunis et al. 2012)</span>, the distribution <span class="math inline">\(p(\Delta t)\)</span> of intervals <span class="math inline">\(\Delta t\)</span> between seroconversions, is
important. Assuming any subject is sampled completely at random during
their intervals between seroconversions, and accounting for interval
length bias <span class="citation">(Satten et al. 2004; Zelen
2004)</span>, the distribution of backward recurrence times <span class="math inline">\(\tau\)</span> can be written as <span class="citation">(Teunis et al. 2012)</span> <span class="math display">\[
u(\tau) = \frac{1}{\overline{\Delta t}} \int_{\tau=0}^{\infty}p(\Delta
t)\text{d}\Delta t
        = \frac{1-P(\Delta t)}{\overline{\Delta t}}
\]</span> where <span class="math inline">\(\overline{\Delta t}\)</span>
is the <span class="math inline">\(p\)</span>–distribution expected
value of <span class="math inline">\(\Delta t\)</span>.</p>
<p>This density is employed to estimate seroconversion rates. The
antibody concentration <span class="math inline">\(y\)</span> is the
observable quantity, and we need to express the probability (density) of
observed <span class="math inline">\(y\)</span> in terms of the density
of backward recurrence time.</p>
<p>First, the backward recurrence time can <span class="math inline">\(\tau\)</span> be expressed as a function of the
serum antibody concentration <span class="math inline">\(y\)</span>
<span class="math display">\[
\tau(y) = \tau_{+}(y) + \tau_{-}(y)
\]</span> where <span class="math display">\[\begin{align*}
\tau_{+}(y) &amp; = \displaystyle{\frac{1}{\mu}}
\log\left(\displaystyle{\frac{y_{+}}{y_{0}}}\right) [0\le
\tau&lt;t_{1}]\\
\tau_{-}(y) &amp; = \left(t_{1} +
\displaystyle{\frac{y_{-}^{-(r-1)}-y_{1}^{-(r-1)}}{\nu(r-1)}}\right)[t_{1}\le
\tau &lt; \infty]
\end{align*}\]</span> with corresponding derivatives <span class="math display">\[
\frac{\text{d}\tau_{+}}{\text{d}y} = \frac{1}{\mu y_{+}} \quad \text{
and } \quad
\frac{\text{d}\tau_{-}}{\text{d}y} = - \frac{1}{\nu y_{-}^{r}}
\]</span></p>
<p>Now, consider the probability that an antibody level <span class="math inline">\(y^{\prime}\)</span>, corresponding to a time since
infection <span class="math inline">\(\tau^{\prime}\)</span>, is less
than or equal to <span class="math inline">\(y\)</span> (see Figure
<span class="math inline">\(\ref{response_graph}\)</span>) <span class="math display">\[\begin{align*}
P(y^{\prime} \le y) &amp; = P\left(y_{0} \le y_{+}(\tau^{\prime})\le
y_{+}(\tau) \vee y_{-}(\tau^{\prime})
                        \le y_{-}(\tau) \le t_{1}\right) + [y_{1} &lt;
y]\\
                    &amp; = P\left(0 \le \tau^{\prime}\le \frac{1}{\mu}
                        \log\left(\frac{y_{+}}{y_{0}}\right)\right)\\
                    &amp;   \qquad {} +
P\left(t_{1}+\frac{y_{-}^{-(r-1)}-y_{1}^{-(r-1)}}{\nu(r-1)} \le
                        \tau^{\prime} &lt; \infty\right) + [y_{1} &lt;
y]
\end{align*}\]</span></p>
<p>The probability density for <span class="math inline">\(y\)</span>
then is <span class="math display">\[\begin{align*}
\rho(y) &amp; = \frac{\text{d}}{\text{d}y} P(y^{\prime}\le y)\\
        &amp; =
\frac{\text{d}}{\text{d}\tau_{+}}\frac{\text{d}\tau_{+}}{\text{d}y_{+}}
            P\left(0\le\tau^{\prime}\le\tau_{+}(y)\right) +
            \frac{\text{d}}{\text{d}\tau_{-}}\frac{\text{d}\tau_{-}}{\text{d}y_{-}}
            P\left(t_{1}+\tau_{-}(y)\le\tau^{\prime}&lt;\infty\right)\\
        &amp; = \rho_{+}(y_{+}) + \rho_{-}(y_{-})
\end{align*}\]</span></p>
<p>So that <span class="math display">\[\begin{equation}\label{rho_y}
\begin{aligned}
\rho_{+}(y_{+}) &amp; = \displaystyle{\frac{1}{\mu y_{+}}}
u\left(\displaystyle{\frac{1}{\mu}}\log\left(\displaystyle{\frac{y_{+}}{y_{0}}}\right)\right)\\
\rho_{-}(y_{-}) &amp; = \displaystyle{\frac{1}{\nu y_{-}^{r}}}
u\left(t_{1} +
\displaystyle{\frac{y_{-}^{-(r-1)}-y_{1}^{-(r-1)}}{\nu(r-1)}}\right)
\end{aligned}
\end{equation}\]</span> when <span class="math inline">\([y_{0} \le y
&lt; y_{1}]\)</span> there are two contributions to the density, one
from the rising and one from the decaying branch of the antibody
response.</p>
<p>If, as assumed before <span class="citation">(Teunis et al.
2012)</span>, intervals between incident infections are generated by a
process with Gamma probability density, <span class="math inline">\(\overline{\Delta t} = (m+1)/\lambda\)</span>. The
cumulative distribution function for <span class="math inline">\(\tau\)</span> is <span class="math display">\[\begin{equation}\label{pm_cumul}
P_{m}(\tau) = 1-\frac{\Gamma(m+1, \lambda\tau)}{m!}
\end{equation}\]</span> and the density of backward recurrence times is
<span class="math display">\[\begin{equation}\label{bwrectime_pdf}
u_{m}(\tau) = \frac{1-P_{m}(\tau)}{\overline{\Delta t}} =
  \frac{\lambda\Gamma(m+1,\lambda\tau)}{(m+1)!} =
  \frac{\lambda\text{e}^{-\lambda\tau}}{m+1}
  \sum_{j=0}^{m}\frac{(\lambda\tau)^{j}}{j!}
\end{equation}\]</span></p>
<p>Combining equations <span class="math inline">\(\eqref{rho_y}\)</span> and <span class="math inline">\(\eqref{bwrectime_pdf}\)</span> the marginal
density of <span class="math inline">\(y\)</span> can be found <span class="math display">\[\begin{equation}
\label{margdist_y_increase}
\rho_{+}(y_{+}) = [y_{0} \le y_{+} &lt; y_{1}] \frac{\lambda
y_{0}}{\mu(m+1)}
                  \left(\frac{y_{+}}{y_{0}}\right)^{-(1+\lambda/\mu)}
                  \sum_{j=0}^{m}
\frac{\left(\frac{\lambda}{\mu}\log(y_{+}/y_{0})\right)^{j}}{j!}
\end{equation}\]</span> and <span class="math display">\[\begin{align}\label{margdist_y_decay}
\rho_{-}(y_{-}) &amp; = [0&lt; y_{-} \le y_{1}] \frac{\lambda}{\nu
y_{-}^{r}(m+1)}
                    \text{e}^{-\lambda\left(t_{1}+\frac{y_{-}^{-(r-1)}-y_{1}^{-(r-1)}}{\nu(r-1)}\right)}
\nonumber\\
                &amp;   \qquad {}
\times\sum_{j=0}^{m}\frac{\lambda^{j}}{j!}\left(t_{1}+
                    \frac{y_{-}^{-(r-1)}-y_{1}^{-(r-1)}}{\nu(r-1)}\right)^{j}
\end{align}\]</span> where <span class="math inline">\(\rho_{+}\)</span>
and <span class="math inline">\(\rho_{-}\)</span> refer to the
contributions of the rising and decaying part of the seroresponse to the
density of <span class="math inline">\(y\)</span>.</p>
<p>The within–host parameters <span class="math inline">\(\boldsymbol{\theta} = (y_{0}, y_{1}, t_{1}, \nu,
r)\)</span> vary among responses of individual subjects. Heterogeneity
in these parameters may be described by their joint distribution, which
can be used to calculate the marginal distribution <span class="math inline">\(\rho(y)\)</span> <span class="citation">(Teunis et
al. 2012)</span>. Since a Monte Carlo sample of the posterior joint
distribution is available from the longitudinal model <span class="citation">(Teunis et al. 2016)</span> the marginal distribution
of <span class="math inline">\(\rho(y)\)</span> may be approximated by
the sum <span class="math display">\[\begin{equation}\label{rho_numsum}
\rho(y) = \frac{1}{N}\sum_{n=1}^{N} \rho_{+}(y\vert \lambda, m,
\boldsymbol{\theta}_{n}) +
          \rho_{-}(y\vert \lambda, m, \boldsymbol{\theta}_{n})
\end{equation}\]</span> for a Monte Carlo sample <span class="math inline">\((\boldsymbol{\theta}_{1}, \boldsymbol{\theta}_{2},
\dots, \boldsymbol{\theta}_{N})\)</span>. A cross–sectional sample of
antibody concentrations <span class="math inline">\((Y_{1}, Y_{2},
\dots, Y_{K})\)</span> can now be used to calculate a likelihood <span class="math display">\[
\ell(\lambda,m) = \prod_{k=1}^{K}\rho(Y_{k}\vert \lambda, m)
\]</span> that can be used to estimate <span class="math inline">\((\lambda, m)\)</span>.</p>
</div>
<div class="section level2">
<h2 id="true-seronegative-subjects">4. True seronegative subjects<a class="anchor" aria-label="anchor" href="#true-seronegative-subjects"></a>
</h2>
<p>At the time that a cross–sectional serum sample is collected, the
subject whose blood is drawn may have never been infected in their
lifetime. The antibody concentration <span class="math inline">\(y\)</span> in that sample then represents a true
seronegative. For such a sample, the backward recurrence time does not
exist. For a given longitudinal response, the backward recurrence time
<span class="math inline">\(\tau\)</span> corresponding with measured
antibody concentration <span class="math inline">\(Y\)</span> can be
calculated. If that backward recurrence time is longer than the age of
the person (at time of sampling), their antibody concentration <span class="math inline">\(Y\)</span> cannot have resulted from prior
seroconversion.</p>
<p>If, in the summation in equation <span class="math inline">\(\eqref{rho_numsum}\)</span>, terms not satisfying
the condition <span class="math inline">\(\tau(y) &lt; a\)</span> are
discarded, the resulting partial sum <span class="math display">\[
\rho^{\ast}(y,a) =
\frac{1}{N}\sum_{n=1}^{N}[\tau(y,\boldsymbol{\theta}_{n}) &lt; a]
                   (\rho_{+}(y\vert\lambda,m,\boldsymbol{\theta}_{n}) +
                   (\rho_{-}(y\vert\lambda,m,\boldsymbol{\theta}_{n})
\]</span> counts only those seroconversions that can have occurred
during the lifespan of the person whose serum was sampled.</p>
<p>Serum from a true seronegative subject is expected to have a low
antibody concentration, representative of a ``true’’ negative sample
<span class="citation">(de Greeff et al. 2012)</span>. The antibody
concentrations <span class="math inline">\(y\)</span> in sera from such
truly negative subjects are not expected to decay over time: the
baseline distribution <span class="math inline">\(\rho_{0}(y)\)</span>
may be assumed fixed and independent of <span class="math inline">\(m\)</span> and <span class="math inline">\(\lambda\)</span>. Note that also when <span class="math inline">\(y\)</span> corresponds to a backward recurrence
time within the lifespan of a person, that same antibody concentration
<span class="math inline">\(y\)</span> could still result from the
baseline distribution <span class="math inline">\(\rho_{0}(y)\)</span>.</p>
<p>Given the interval distribution for incident infections, the
probability that a sampled subject has never seroconverted depends on
their age. For the gamma process assumed above, the survival function
<span class="math inline">\(P_{m}(a\vert m, \lambda)\)</span> gives the
probability of a subject having not seroconverted before age <span class="math inline">\(a\)</span> (equation <span class="math inline">\(\eqref{pm_cumul}\)</span>).</p>
<p>Thus, for a serum sample with antibody concentration <span class="math inline">\(y\)</span> from a subject of age <span class="math inline">\(a\)</span> the probability density is <span class="math display">\[
\psi (\lambda, m\vert y, a, \boldsymbol{\theta},
\boldsymbol{\theta}_{0}) =
\rho^{\ast}(y, a) + P_{m}(a\vert m, \lambda)\rho_{0}(y\vert
\boldsymbol{\theta}_{0})
\]</span></p>
<p>When the seroconversion rate is low, or a subject is young, or both,
the probability of a true negative may be considerable.</p>
</div>
<div class="section level2">
<h2 id="censored-observations">5. Censored observations<a class="anchor" aria-label="anchor" href="#censored-observations"></a>
</h2>
<p>In case observations are censored at <span class="math inline">\(y_{c}\)</span> such that an observed <span class="math inline">\(Y = \max(Y,y_{c})\)</span>, then for <span class="math inline">\(y_{c} &lt; Y\)</span> the density <span class="math inline">\(\rho(y)\)</span> as in equations <span class="math inline">\(\eqref{margdist_y_increase}\)</span> and <span class="math inline">\(\eqref{margdist_y_decay}\)</span> holds, but the
likelihood of any <span class="math inline">\(Y \le y_{c}\)</span> can
be calculated <span class="math display">\[
\ell(\lambda, m \vert y \le y_{c}) = \int_{z=0}^{y_{c}} \rho(z, \lambda,
m) \text{d}z = R(y_{c}\vert\lambda,m)
\]</span> We need the cumulative distribution <span class="math inline">\(R(y)\)</span> for the backward recurrence time,
from equation <span class="math inline">\(\eqref{bwrectime_pdf}\)</span>. <span class="math display">\[
U_{m}(\tau) = \frac{1}{m+1}\sum_{j=0}^{m} P_{j}(\tau\vert\lambda)
\]</span> while the cumulative distribution of antibody levels <span class="math inline">\(y\)</span> is <span class="math display">\[\begin{align*}
P(y^{\prime} \le y) &amp; =
U\left(\frac{1}{\mu}\log\left(\frac{y}{y_{0}} \right)\right) [y_{0}\le y
&lt; y_{1}] +\\
                    &amp;   \qquad {}
\left(1-U\left(t_{1}+\frac{y^{-(r-1)}-y_{1}^{-(r-1)}}
                        {\nu(r-1)}\right)\right) [y\le y_{1}] + [y_{1}
&lt; y]
\end{align*}\]</span> so that <span class="math display">\[\begin{align*}
R(y) &amp; = \frac{1}{m+1}\sum_{j=0}^{m}P_{j} \left(\frac{1}{\mu}\log
         \left(\frac{y}{y_{0}}\right)\vert\lambda\right) [y_{0} \le y
&lt; y_{1}]\\
     &amp;   \qquad {} + \left(1 -
\frac{1}{m+1}\sum_{j=0}^{m}P_{j}\left(t_{1}+
         \frac{y^{-(r-1)}-y_{1}^{-(r-1)}}{\nu(r-1)}\vert\lambda\right)\right)[y
\le y_{1}]\\
     &amp;   \qquad {} + [y_{1} &lt; y]
\end{align*}\]</span></p>
<p>Using equation <span class="math inline">\(\eqref{pm_cumul}\)</span>
this can be written in terms of incomplete gamma functions <span class="math display">\[\begin{align*}
R(y) &amp; =
\frac{1}{m+1}\sum_{j=0}^{m}  \left(1-\frac{\Gamma\left(j+1,\frac{\lambda}{\mu}
         \log\left(\frac{y}{y_{0}}\right)\right)}{j!}\right) [y_{0} \le
y &lt; y_{1}]\\
     &amp;   \qquad {} + \left(1-\frac{1}{m+1}\sum_{j=0}^{m}
\left(1-\frac{\Gamma\left(j+1,\lambda\left(t_{1} +
         \frac{y^{-(r-1)}-y_{1}^{-(r-1)}}{\nu(r-1)}\right)\right)}{j!}\right)\right)[y
&lt; y_{1}]\\
     &amp;   \qquad {} + [y_{1} &lt; y]
\end{align*}\]</span> or <span class="math display">\[\begin{align*}
R(y) &amp; = \left(1-\frac{1}{m+1}\sum_{j=0}^{m}
\frac{\Gamma\left(j+1,\frac{\lambda}{\mu}
         \log\left(\frac{y}{y_{0}}\right)\right)}{j!}\right) [y_{0} \le
y &lt; y_{1}]\\
     &amp;   \qquad {} + \frac{1}{m+1}\sum_{j=0}^{m}
\frac{\Gamma\left(j+1,\lambda\left(t_{1} +
         \frac{y^{-(r-1)}-y_{1}^{-(r-1)}}{\nu(r-1)}\right)\right)}{j!}
[y &lt; y_{1}]\\
     &amp;   \qquad {} + [y_{1} &lt; y]
\end{align*}\]</span></p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-degraaf_etal14wh" class="csl-entry">
Graaf, W. F. de, M. E. E. Kretzschmar, P. F. M. Teunis, and O. Diekmann.
2014. <span>“A Two-Phase Within-Host Model for Immune Response and Its
Application to Serological Profiles of Pertussis.”</span>
<em>Epidemics</em> 9 (December): 1–7. <a href="https://doi.org/10.1016/j.epidem.2014.08.002" class="external-link">https://doi.org/10.1016/j.epidem.2014.08.002</a>.
</div>
<div id="ref-degreeff_etal12" class="csl-entry">
Greeff, S. C. de, P. F. M. Teunis, H. E. de Melker, F. R. Mooi, D. W.
Notermans, B. Elvers, and J. F. P. Schellekens. 2012.
<span>“Two-Component Cluster Analysis of a Large Serodiagnostic Database
for Specificity of Increases of IgG Antibodies Against Pertussis Toxin
in Paired Serum Samples and of Absolute Values in Single Serum
Samples.”</span> <em>Clinical and Vaccine Immunology</em> 19 (9). <a href="https://doi.org/10.1128/CVI.00229-12" class="external-link">https://doi.org/10.1128/CVI.00229-12</a>.
</div>
<div id="ref-satten_etal04" class="csl-entry">
Satten, G. A., F. Kong, D. J. Wright, S. A. Glynn, and G. B. Schreiber.
2004. <span>“How Special Is a <span>‘Special’</span> Interval: Modeling
Departure from Length‐biased Sampling in Renewal Processes.”</span>
<em>Biostatistics</em> 5 (1). <a href="https://doi.org/10.1093/biostatistics/5.1.145" class="external-link">https://doi.org/10.1093/biostatistics/5.1.145</a>.
</div>
<div id="ref-teunis_etal12_biomarker" class="csl-entry">
Teunis, P. F. M., J. C. van Eijkeren, C. W. Ang, Y. T. van Duynhoven, J.
B. Simonsen, M. A. Strid, and W. van Pelt. 2012. <span>“Biomarker
Dynamics: Estimating Infection Rates from Serological Data.”</span>
<em>Statistics in Medicine</em> 31 (20): 2240–48. <a href="https://doi.org/10.1002/sim.5322" class="external-link">https://doi.org/10.1002/sim.5322</a>.
</div>
<div id="ref-teunis_etal16withinhost" class="csl-entry">
Teunis, P. F. M., J. C. van Eijkeren, W. F. de Graaf, A. Bonačić
Marinović, and M. E. E. Kretzschmar. 2016. <span>“Linking the
Seroresponse to Infection to Within-Host Heterogeneity in Antibody
Production.”</span> <em>Epidemics</em> 16 (September). <a href="https://doi.org/10.1016/j.epidem.2016.04.001" class="external-link">https://doi.org/10.1016/j.epidem.2016.04.001</a>.
</div>
<div id="ref-zelen04" class="csl-entry">
Zelen, M. 2004. <span>“Forward and Backward Recurrence Times and Length
Biased Sampling: Age Specific Models.”</span> <em>Lifetime Data
Analysis</em> 10 (4).
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peter Teunis, Kristina Lai, Kristen Aiemjoy, Douglas Ezra Morrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
