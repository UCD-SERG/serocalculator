<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generate a simulated cross-sectional sample and estimate seroincidence • serocalculator</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="simulate_xsectionalData_files/libs/quarto-html/popper.min.js"></script><script src="simulate_xsectionalData_files/libs/quarto-html/tippy.umd.min.js"></script><link href="simulate_xsectionalData_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="simulate_xsectionalData_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="simulate_xsectionalData_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="simulate_xsectionalData_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="simulate_xsectionalData_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="simulate_xsectionalData_files/libs/datatables-binding-0.33/datatables.js"></script><link href="simulate_xsectionalData_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="simulate_xsectionalData_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<link href="simulate_xsectionalData_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="simulate_xsectionalData_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate a simulated cross-sectional sample and estimate seroincidence">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">serocalculator</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">1.3.0.9030</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/serocalculator.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/serocalculator.html">Introduction to serocalculator</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methodology</h6></li>
    <li><a class="dropdown-item" href="../articles/methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/simulate_xsectionalData.html">Generate a simulated cross-sectional sample and estimate seroincidence</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/enteric_fever_example.html">Enteric Fever Seroincidence Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/scrubTyphus_example.html">Scrub Typhus Seroincidence Vignette</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UCD-SERG/serocalculator/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate a simulated cross-sectional sample and estimate seroincidence</h1>
      <p class="subtitle">Simulation of Enteric Fever using HlyE IgG and/or HlyE IgA</p>



      <small class="dont-index">Source: <a href="https://github.com/UCD-SERG/serocalculator/blob/simple-sim/vignettes/articles/simulate_xsectionalData.qmd" class="external-link"><code>vignettes/articles/simulate_xsectionalData.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>This vignette shows how to simulate a cross-sectional sample of seroresponses for incident infections as a Poisson process with frequency <code>lambda</code>. Responses are generated for the antibodies given in the <code>antigen_isos</code> argument.</p>
<p>Age range of the simulated cross-sectional record is <code>lifespan</code>.</p>
<p>The size of the sample is <code>nrep</code>.</p>
<p>Each individual is simulated separately, but different antibodies are modelled jointly.</p>
<p>Longitudinal parameters are calculated for an age: <code>age_fixed</code> (fixed age). However, when <code>age_fixed</code> is set to NA then the age at infection is used.</p>
<p>The boolean <code>renew_params</code> determines whether each infection uses a new set of longitudinal parameters, sampled at random from the posterior predictive output of the longitudinal model. If set to <code>FALSE</code>, a parameter set is chosen at birth and kept, but:</p>
<ol type="1">
<li><p>the baseline antibody levels (<code>y0</code>) are updated with the simulated level (just) prior to infection, and</p></li>
<li><p>when <code>age_fixed = NA</code>, the selected parameter sample is updated for the age when infection occurs.</p></li>
</ol>
<p>For our initial simulations, we will set <code>renew_params = FALSE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">renew_params</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
<p>There is also a variable <code>n_mcmc_samples</code>: when <code>n_mcmc_samples==0</code> then a random MC sample is chosen out of the posterior set (1:4000). When <code>n_mcmc_samples</code> is given a value in 1:4000, the chosen number is fixed and reused in any subsequent infection. This is for diagnostic purposes.</p>
<section class="section level2"><h2 id="simulate-a-single-dataset">Simulate a single dataset<a class="anchor" aria-label="anchor" href="#simulate-a-single-dataset"></a>
</h2>
<section class="level2"><h3 id="load-model-parameters">load model parameters<a class="anchor" aria-label="anchor" href="#load-model-parameters"></a>
</h3>
<p>Here we load in longitudinal parameters; these are modeled from all SEES cases across all ages and countries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ucd-serg.github.io/serocalculator/" class="external-link">serocalculator</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.5</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ ggplot2   3.5.1     ✔ tibble    3.2.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1</span></span>
<span><span class="co">#&gt; ✔ purrr     1.0.4     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eclarke/ggbeeswarm" class="external-link">ggbeeswarm</a></span><span class="op">)</span> <span class="co"># for plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/units/" class="external-link">units</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; udunits database from /usr/share/xml/udunits/udunits2.xml</span></span>
<span><span class="co"># Specify the antibody-isotype responses to include in analyses</span></span>
<span><span class="va">antibodies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HlyE_IgA"</span>, <span class="st">"HlyE_IgG"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dmcmc</span> <span class="op">&lt;-</span></span>
<span>  <span class="st">"https://osf.io/download/rtw5k"</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/load_curve_params.html">load_curve_params</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">iter</span> <span class="op">&lt;=</span> <span class="fl">50</span>, <span class="co"># reduce number of mcmc samples for speed</span></span>
<span>    <span class="va">antigen_iso</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">antibodies</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="co"># |&gt; </span></span>
<span>  <span class="co"># mutate(</span></span>
<span>  <span class="co">#   alpha = alpha |&gt; units::as_units("1/days"),</span></span>
<span>  <span class="co">#   t1 = 0 |&gt; units::as_units("days")</span></span>
<span>  <span class="co"># )</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="visualize-antibody-decay-model">visualize antibody decay model<a class="anchor" aria-label="anchor" href="#visualize-antibody-decay-model"></a>
</h3>
<p>We can graph individual MCMC samples from the posterior distribution of model parameters using a <code><a href="../reference/autoplot.curve_params.html">autoplot.curve_params()</a></code> method for the <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dmcmc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">antigen_iso</span> <span class="op">==</span> <span class="st">"HlyE_IgG"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/graph.curve.params.html">graph.curve.params</a></span><span class="op">(</span>show_all_curves <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     log_x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can use a logarithmic scale for the x-axis if desired:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dmcmc</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>log_x <span class="op">=</span> <span class="cn">TRUE</span>, n_curves <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can graph the median, 10%, and 90% quantiles of the model using the <code><a href="../reference/graph.curve.params.html">graph.curve.params()</a></code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dmcmc</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="../reference/graph.curve.params.html">graph.curve.params</a></span><span class="op">(</span>antigen_isos <span class="op">=</span> <span class="va">antibodies</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/graph-curve-params-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="simulate-cross-sectional-data">Simulate cross-sectional data<a class="anchor" aria-label="anchor" href="#simulate-cross-sectional-data"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set seed to reproduce results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">54321</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulated incidence rate per person-year</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>  <span class="co"># |&gt; units::as_units("1/years")</span></span>
<span><span class="co"># range covered in simulations</span></span>
<span><span class="va">lifespan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># |&gt; units::as_units("years")</span></span>
<span><span class="co"># cross-sectional sample size</span></span>
<span><span class="va">nrep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># biologic noise distribution</span></span>
<span><span class="va">dlims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="st">"HlyE_IgA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="st">"HlyE_IgG"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">verbose</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># whether to print verbose updates as the function runs</span></span>
<span></span>
<span><span class="co"># generate cross-sectional data</span></span>
<span><span class="va">csdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_pop_data_2.html">sim_pop_data_2</a></span><span class="op">(</span></span>
<span>  curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="va">nrep</span>,</span>
<span>  age_range <span class="op">=</span> <span class="va">lifespan</span>,</span>
<span>  antigen_isos <span class="op">=</span> <span class="va">antibodies</span>,</span>
<span>  n_mcmc_samples <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  renew_params <span class="op">=</span> <span class="va">renew_params</span>,</span>
<span>  add_noise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  noise_limits <span class="op">=</span> <span class="va">dlims</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"long"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="noise-parameters">Noise parameters<a class="anchor" aria-label="anchor" href="#noise-parameters"></a>
</h3>
<p>We need to provide noise parameters for the analysis; here, we define them directly in our code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  antigen_iso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HlyE_IgG"</span>, <span class="st">"HlyE_IgA"</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="co"># Biologic noise (nu)</span></span>
<span>  eps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># M noise (eps)</span></span>
<span>  y.low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># low cutoff (llod)</span></span>
<span>  y.high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5e6</span>, <span class="fl">5e6</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="co"># high cutoff (y.high)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="visualize-data">Visualize data<a class="anchor" aria-label="anchor" href="#visualize-data"></a>
</h3>
<p>We can plot the distribution of the antibody responses in the simulated data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csdata</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">antigen_iso</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_beeswarm.html" class="external-link">geom_beeswarm</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fl">.2</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">antigen_iso</span><span class="op">)</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.colour <span class="op">=</span> <span class="cn">NA</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"antigen - isotype"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="calculate-log-likelihood">calculate log-likelihood<a class="anchor" aria-label="anchor" href="#calculate-log-likelihood"></a>
</h3>
<p>We can calculate the log-likelihood of the data as a function of the incidence rate directly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ll_a</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/log_likelihood.html">log_likelihood</a></span><span class="op">(</span></span>
<span>    pop_data <span class="op">=</span> <span class="va">csdata</span>,</span>
<span>    curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>    noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>    antigen_isos <span class="op">=</span> <span class="st">"HlyE_IgA"</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -289.2933</span></span>
<span></span>
<span><span class="va">ll_g</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/log_likelihood.html">log_likelihood</a></span><span class="op">(</span></span>
<span>    pop_data <span class="op">=</span> <span class="va">csdata</span>,</span>
<span>    curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>    noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>    antigen_isos <span class="op">=</span> <span class="st">"HlyE_IgG"</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -292.3652</span></span>
<span></span>
<span><span class="va">ll_ag</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/log_likelihood.html">log_likelihood</a></span><span class="op">(</span></span>
<span>    pop_data <span class="op">=</span> <span class="va">csdata</span>,</span>
<span>    curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>    noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>    antigen_isos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HlyE_IgG"</span>, <span class="st">"HlyE_IgA"</span><span class="op">)</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -581.6586</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ll_a</span> <span class="op">+</span> <span class="va">ll_g</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -581.6586</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="graph-log-likelihood">graph log-likelihood<a class="anchor" aria-label="anchor" href="#graph-log-likelihood"></a>
</h3>
<p>We can also graph the log-likelihoods, even without finding the MLEs, using <code><a href="../reference/graph_loglik.html">graph_loglik()</a></code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lik_HlyE_IgA</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_loglik.html">graph_loglik</a></span><span class="op">(</span></span>
<span>    pop_data <span class="op">=</span> <span class="va">csdata</span>,</span>
<span>    curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>    noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>    antigen_isos <span class="op">=</span> <span class="st">"HlyE_IgA"</span>,</span>
<span>    log_x <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">lik_HlyE_IgG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_loglik.html">graph_loglik</a></span><span class="op">(</span></span>
<span>  previous_plot <span class="op">=</span> <span class="va">lik_HlyE_IgA</span>,</span>
<span>  pop_data <span class="op">=</span> <span class="va">csdata</span>,</span>
<span>  curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>  noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>  antigen_isos <span class="op">=</span> <span class="st">"HlyE_IgG"</span>,</span>
<span>  log_x <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">lik_both</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_loglik.html">graph_loglik</a></span><span class="op">(</span></span>
<span>  previous_plot <span class="op">=</span> <span class="va">lik_HlyE_IgG</span>,</span>
<span>  pop_data <span class="op">=</span> <span class="va">csdata</span>,</span>
<span>  curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>  noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>  antigen_isos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HlyE_IgG"</span>, <span class="st">"HlyE_IgA"</span><span class="op">)</span>,</span>
<span>  log_x <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lik_both</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="estimate-incidence">estimate incidence<a class="anchor" aria-label="anchor" href="#estimate-incidence"></a>
</h3>
<p>We can estimate incidence with <code><a href="../reference/est.incidence.html">est.incidence()</a></code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">est1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est.incidence.html">est.incidence</a></span><span class="op">(</span></span>
<span>  pop_data <span class="op">=</span> <span class="va">csdata</span>,</span>
<span>  curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>  noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>  lambda_start <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>  build_graph <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="va">verbose</span>,</span>
<span>  print_graph <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># display the log-likelihood curve while</span></span>
<span>  <span class="co">#`est.incidence()` is running</span></span>
<span>  antigen_isos <span class="op">=</span> <span class="va">antibodies</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>We can extract summary statistics with <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">est1</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 10</span></span>
<span><span class="co">#&gt;   est.start incidence.rate     SE CI.lwr CI.upr coverage log.lik iterations</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt;          &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;      &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1       0.1          0.267 0.0271  0.218  0.325     0.95   -546.          6</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: antigen.isos &lt;chr&gt;, nlm.convergence.code &lt;ord&gt;</span></span></code></pre></div>
</div>
<p>We can plot the log-likelihood curve with <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">est1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can set the x-axis to a logarithmic scale:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">est1</span>, log_x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="section level2"><h2 id="simulate-multiple-clusters-with-different-lambdas">Simulate multiple clusters with different lambdas<a class="anchor" aria-label="anchor" href="#simulate-multiple-clusters-with-different-lambdas"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span><span class="va">n_cores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">n_cores</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
<p>In the preceding code chunk, we have determined that we can use 3 CPU cores to run computations in parallel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># number of clusters</span></span>
<span><span class="va">nclus</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="co"># cross-sectional sample size</span></span>
<span><span class="va">nrep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># incidence rate in e</span></span>
<span><span class="va">lambdas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.1</span>, <span class="fl">.15</span>, <span class="fl">.2</span>, <span class="fl">.5</span>, <span class="fl">.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/sim_pop_data_multi.html">sim_pop_data_multi</a></span><span class="op">(</span></span>
<span>    sim_function <span class="op">=</span> <span class="va">sim_pop_data_2</span>,</span>
<span>    n_cores <span class="op">=</span> <span class="va">n_cores</span>,</span>
<span>    lambdas <span class="op">=</span> <span class="va">lambdas</span>,</span>
<span>    nclus <span class="op">=</span> <span class="va">nclus</span>,</span>
<span>    n_samples <span class="op">=</span> <span class="va">nrep</span>,</span>
<span>    age_range <span class="op">=</span> <span class="va">lifespan</span>,</span>
<span>    antigen_isos <span class="op">=</span> <span class="va">antibodies</span>,</span>
<span>    renew_params <span class="op">=</span> <span class="va">renew_params</span>,</span>
<span>    add_noise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>    noise_limits <span class="op">=</span> <span class="va">dlims</span>,</span>
<span>    format <span class="op">=</span> <span class="st">"long"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 24,000 × 6</span></span>
<span><span class="co">#&gt;    id      age antigen_iso  value lambda.sim cluster</span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 1      4.79 HlyE_IgA    0.0985       0.05       1</span></span>
<span><span class="co">#&gt;  2 1      4.79 HlyE_IgG    0.380        0.05       1</span></span>
<span><span class="co">#&gt;  3 2      2.54 HlyE_IgA    0.222        0.05       1</span></span>
<span><span class="co">#&gt;  4 2      2.54 HlyE_IgG    0.371        0.05       1</span></span>
<span><span class="co">#&gt;  5 3      4.10 HlyE_IgA    0.184        0.05       1</span></span>
<span><span class="co">#&gt;  6 3      4.10 HlyE_IgG    0.0477       0.05       1</span></span>
<span><span class="co">#&gt;  7 4      6.70 HlyE_IgA    0.437        0.05       1</span></span>
<span><span class="co">#&gt;  8 4      6.70 HlyE_IgG    0.459        0.05       1</span></span>
<span><span class="co">#&gt;  9 5      3.77 HlyE_IgA    0.203        0.05       1</span></span>
<span><span class="co">#&gt; 10 5      3.77 HlyE_IgG    0.371        0.05       1</span></span>
<span><span class="co">#&gt; # ℹ 23,990 more rows</span></span></code></pre></div>
</div>
<p>We can plot the distributions of the simulated responses:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_beeswarm.html" class="external-link">geom_beeswarm</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.2</span>, alpha <span class="op">=</span> <span class="fl">.3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">antigen_iso</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.colour <span class="op">=</span> <span class="cn">NA</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">antigen_iso</span> <span class="op">+</span> <span class="va">lambda.sim</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<section class="level2"><h3 id="estimate-incidence-in-each-cluster">Estimate incidence in each cluster<a class="anchor" aria-label="anchor" href="#estimate-incidence-in-each-cluster"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ests</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/est.incidence.by.html">est.incidence.by</a></span><span class="op">(</span></span>
<span>    pop_data <span class="op">=</span> <span class="va">sim_df</span>,</span>
<span>    curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>    noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>    num_cores <span class="op">=</span> <span class="va">n_cores</span>,</span>
<span>    strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lambda.sim"</span>, <span class="st">"cluster"</span><span class="op">)</span>,</span>
<span>    curve_strata_varnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    noise_strata_varnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    verbose <span class="op">=</span> <span class="va">verbose</span>,</span>
<span>    build_graph <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># slows down the function substantially</span></span>
<span>    antigen_isos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HlyE_IgG"</span>, <span class="st">"HlyE_IgA"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p><code>summary(ests)</code> produces a <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble()</a></code> with some extra meta-data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ests_summary</span> <span class="op">&lt;-</span> <span class="va">ests</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Seroincidence estimated given the following setup:</span></span>
<span><span class="co">#&gt; a) Antigen isotypes   : HlyE_IgG, HlyE_IgA </span></span>
<span><span class="co">#&gt; b) Strata       : lambda.sim, cluster </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Seroincidence estimates:</span></span>
<span><span class="co">#&gt; # A tibble: 120 × 14</span></span>
<span><span class="co">#&gt;    Stratum    lambda.sim cluster     n est.start incidence.rate      SE CI.lwr</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;           &lt;dbl&gt;   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Stratum 1        0.05       1   100       0.1         0.0631 0.00992 0.0464</span></span>
<span><span class="co">#&gt;  2 Stratum 2        0.05       2   100       0.1         0.0678 0.0105  0.0500</span></span>
<span><span class="co">#&gt;  3 Stratum 3        0.05       3   100       0.1         0.0816 0.0120  0.0611</span></span>
<span><span class="co">#&gt;  4 Stratum 4        0.05       4   100       0.1         0.0573 0.00971 0.0411</span></span>
<span><span class="co">#&gt;  5 Stratum 5        0.05       5   100       0.1         0.0617 0.00983 0.0452</span></span>
<span><span class="co">#&gt;  6 Stratum 6        0.05       6   100       0.1         0.0572 0.00973 0.0410</span></span>
<span><span class="co">#&gt;  7 Stratum 7        0.05       7   100       0.1         0.0569 0.00971 0.0407</span></span>
<span><span class="co">#&gt;  8 Stratum 8        0.05       8   100       0.1         0.0780 0.0120  0.0577</span></span>
<span><span class="co">#&gt;  9 Stratum 9        0.05       9   100       0.1         0.0486 0.00873 0.0341</span></span>
<span><span class="co">#&gt; 10 Stratum 10       0.05      10   100       0.1         0.0765 0.0118  0.0566</span></span>
<span><span class="co">#&gt; # ℹ 110 more rows</span></span>
<span><span class="co">#&gt; # ℹ 6 more variables: CI.upr &lt;dbl&gt;, coverage &lt;dbl&gt;, log.lik &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   iterations &lt;int&gt;, antigen.isos &lt;chr&gt;, nlm.convergence.code &lt;ord&gt;</span></span></code></pre></div>
</div>
<p>We can explore the summary table interactively using <code><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">DT::datatable()</a></code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span></span>
<span><span class="va">ests_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span>options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html" class="external-link">formatRound</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"incidence.rate"</span>,</span>
<span>      <span class="st">"SE"</span>,</span>
<span>      <span class="st">"CI.lwr"</span>,</span>
<span>      <span class="st">"CI.upr"</span>,</span>
<span>      <span class="st">"log.lik"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-63ba5dd57bc319c45d35" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-63ba5dd57bc319c45d35">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120"],["Stratum 1","Stratum 2","Stratum 3","Stratum 4","Stratum 5","Stratum 6","Stratum 7","Stratum 8","Stratum 9","Stratum 10","Stratum 11","Stratum 12","Stratum 13","Stratum 14","Stratum 15","Stratum 16","Stratum 17","Stratum 18","Stratum 19","Stratum 20","Stratum 21","Stratum 22","Stratum 23","Stratum 24","Stratum 25","Stratum 26","Stratum 27","Stratum 28","Stratum 29","Stratum 30","Stratum 31","Stratum 32","Stratum 33","Stratum 34","Stratum 35","Stratum 36","Stratum 37","Stratum 38","Stratum 39","Stratum 40","Stratum 41","Stratum 42","Stratum 43","Stratum 44","Stratum 45","Stratum 46","Stratum 47","Stratum 48","Stratum 49","Stratum 50","Stratum 51","Stratum 52","Stratum 53","Stratum 54","Stratum 55","Stratum 56","Stratum 57","Stratum 58","Stratum 59","Stratum 60","Stratum 61","Stratum 62","Stratum 63","Stratum 64","Stratum 65","Stratum 66","Stratum 67","Stratum 68","Stratum 69","Stratum 70","Stratum 71","Stratum 72","Stratum 73","Stratum 74","Stratum 75","Stratum 76","Stratum 77","Stratum 78","Stratum 79","Stratum 80","Stratum 81","Stratum 82","Stratum 83","Stratum 84","Stratum 85","Stratum 86","Stratum 87","Stratum 88","Stratum 89","Stratum 90","Stratum 91","Stratum 92","Stratum 93","Stratum 94","Stratum 95","Stratum 96","Stratum 97","Stratum 98","Stratum 99","Stratum 100","Stratum 101","Stratum 102","Stratum 103","Stratum 104","Stratum 105","Stratum 106","Stratum 107","Stratum 108","Stratum 109","Stratum 110","Stratum 111","Stratum 112","Stratum 113","Stratum 114","Stratum 115","Stratum 116","Stratum 117","Stratum 118","Stratum 119","Stratum 120"],[0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.05,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.15,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],[100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100],[0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1],[0.06313945603249817,0.06783972951247923,0.08162097844986389,0.05730430661441836,0.06173093626671274,0.05716965684556755,0.05685079969380119,0.07796017112395284,0.04855495598915709,0.07647345198264596,0.05892012533936909,0.07201059152942185,0.07566162387379824,0.05279296385235843,0.0586042151733502,0.0665959386923524,0.0756342072662914,0.04010281505090042,0.05705214897582567,0.06310726401777514,0.08968189998467702,0.1525293692528007,0.1585589302452455,0.09097391368321707,0.1720113249160177,0.2113634044245802,0.1449577680212275,0.1219146400274985,0.1120751226696777,0.1599374356116776,0.1397238488614012,0.1427578616249157,0.1245148759287159,0.1395172255756784,0.1108544710045316,0.1435488794355919,0.1362085748101827,0.1735620908369362,0.1174350851505309,0.1537176415442562,0.2373982368966801,0.2088005741288031,0.1829835867000398,0.219352982679261,0.1989695612753614,0.1725164313182456,0.210700947700204,0.2052243071391738,0.202625043764652,0.2227368772537937,0.2382374453968993,0.1904811625177375,0.1630648818188611,0.134442815543479,0.1412152993114615,0.2262811188012083,0.1247391867969545,0.1580523931115649,0.1960384028733714,0.2683185121984812,0.2642226242733079,0.2954519989354778,0.3091955537022235,0.3387304783537285,0.3171943061844644,0.3026011439871789,0.274759464289701,0.2754892918093813,0.2313479199349658,0.2904951595228341,0.296978465392162,0.261904793935135,0.299060996709417,0.2311447148852903,0.25822786270329,0.2628535923473849,0.2324934401585257,0.2651659839428395,0.261824335758893,0.288531460373239,0.4201840757195758,0.4757689864123331,0.5360277930597483,0.5151663278029559,0.4401747742761447,0.3528903487004366,0.4483740935067101,0.539903791983053,0.4574123113230472,0.4579985318661273,0.3528751830153314,0.4860452836390936,0.4772583088952814,0.4081477677473309,0.3987644013347466,0.4823255657186769,0.384741353327148,0.4354802867151435,0.5289511211624858,0.3858972985453027,0.4188659999224885,0.43891854648861,0.4725188760658197,0.444902196177008,0.4369783580777687,0.4795256852477093,0.5368622622368149,0.4925531637698797,0.4583697096995075,0.5203178343059341,0.5067426697262544,0.4149971816422112,0.4701670662218992,0.5007468450847136,0.4572373638514947,0.5084992788183615,0.4718048941606047,0.4150760602606112,0.4362516849086674,0.5118436492769322],[0.009921623730204681,0.01054545053887325,0.01204724884516028,0.009711007877059943,0.009834623505437245,0.009731973900990532,0.009707788769973361,0.01197253930033479,0.0087277244819655,0.01176133560639064,0.009717661363424616,0.01110765556260411,0.01184018385502095,0.009080339339416025,0.009807819411371583,0.01038226811224065,0.0117762964265982,0.007784007122330164,0.01000567490089221,0.01021411764991985,0.01339252120683613,0.01806307937163313,0.0188344395919573,0.01256973018907277,0.01946819472193333,0.02368109580672495,0.01716273134231427,0.01551640244514917,0.01535332477927091,0.01884915648073909,0.01733170026479397,0.0170531567344691,0.01626746787555493,0.01757637579253106,0.01464066145751161,0.01759102631916309,0.01642262241782353,0.02008100759910893,0.01501636564531229,0.0183313203436956,0.02435917599390333,0.02167200335327613,0.02057987925121874,0.02355921003438344,0.02112270902430274,0.01968549109809673,0.02220406230520085,0.02224784458884319,0.02256728558660364,0.02356689438727202,0.02448768077385304,0.02135382453474185,0.01908768043267046,0.01640368926191088,0.01755602548831847,0.02316492507822665,0.01573824727761493,0.01847283206757685,0.02171104578103301,0.02723748107955604,0.02642947017543142,0.02880415248970115,0.02950374244050514,0.03252863284164451,0.03129992167547227,0.02934878720266,0.02701869498030893,0.02711084344386547,0.0234194971800219,0.02870376469044703,0.02886387785979866,0.02590801345098484,0.0290809680214256,0.02444938314810484,0.02530438797217604,0.02667039819725894,0.02443534525809861,0.02618235209964925,0.02634065004995591,0.02775330230850915,0.03847145505533393,0.04435159490481467,0.04856921182108258,0.04657330354698724,0.03984172620768984,0.03297332001260895,0.04103523037150215,0.04909107616609308,0.04097084651969364,0.04217627631997141,0.03212526781700179,0.04461310679006928,0.04246533114717428,0.0366929467525374,0.03653142724056486,0.04315614489259949,0.03500930093091924,0.03854292966642445,0.04853503881024692,0.03614216643055209,0.03758494719217349,0.03887709119928854,0.04305156610893097,0.04015171807859586,0.03990380779458239,0.04404189477146993,0.04909156186724657,0.04444477645959077,0.04155407446775697,0.04570469468055911,0.04604143252652431,0.03717270782736948,0.04267789184578998,0.04490921730612265,0.04084621559344877,0.04562704248788822,0.04195588301420212,0.03685381984384072,0.03913774549649124,0.0459434631369883],[0.04640283488533132,0.0500227751292408,0.06111735176895254,0.04110923350937701,0.04517459315503566,0.04095112118228721,0.04068049304235107,0.05769678642972541,0.03413741197502537,0.05657167377665421,0.04264572438965799,0.05322286910042953,0.05567654723204153,0.03768514514599539,0.04221574015656281,0.04906207581759296,0.0557423934476981,0.02741293670013937,0.04045667952075763,0.04595254728131766,0.06692552822464289,0.1209347497085624,0.1256263206070636,0.06939171620417944,0.1377901849565333,0.1696920187584773,0.1149372512455308,0.09499946569533989,0.08568443866975781,0.1269501468098403,0.1095684060997653,0.11295869231214,0.09638611985461025,0.1089917151888374,0.08557249015102769,0.1128990605737381,0.1075413199738003,0.1383475505010097,0.09140188473509217,0.1216788807872464,0.1941496539026507,0.1703660553653361,0.1467840353520499,0.1777140577477659,0.1615930421278461,0.1379436230301338,0.1713820245300528,0.1659404280996201,0.1628886711145643,0.1810213961262765,0.1947680351911045,0.1529073563323241,0.1296350421993547,0.1058474657126459,0.1106775493424366,0.185143655038645,0.09741087945374625,0.1256939648465631,0.1577870966367221,0.2199093429511953,0.2171833998298885,0.2440628884307569,0.2564547547643455,0.2806160610725806,0.2614152955920036,0.2502153379679732,0.2265943444571427,0.2271632938118126,0.1897133640349987,0.2393491323317867,0.2454681393641933,0.2157452882170729,0.2471656707762859,0.187865891164059,0.2131040742038941,0.2154501926443119,0.1892118705553873,0.2185096447624547,0.2149688276053951,0.2389558610005224,0.351159797021104,0.3963203631848098,0.4488077625470324,0.4315142110769191,0.3686209241332195,0.2938362195448244,0.3747472746635753,0.4517730986457049,0.3837646210091836,0.3823652696687534,0.2952085333253243,0.4060192989990042,0.4008810895563863,0.3422105879601732,0.3332241609541862,0.404742593056894,0.3218950598248827,0.3661267391984258,0.4418875117627852,0.3211813738237878,0.3513149162418044,0.3689682416177807,0.3952442138191192,0.3727734382279108,0.3653677917175933,0.4005285889066015,0.4487739279229733,0.4127111975030658,0.3837506985727863,0.438025311817682,0.4240815020503327,0.3481770429177513,0.3935384249307664,0.4200284031484172,0.3837970576375119,0.4264940998984261,0.3963402716769449,0.3487796260749648,0.3659086629905489,0.4292722763218801],[0.08591265852466255,0.09200267055228037,0.1090031542645703,0.07987946444708681,0.08435512588429736,0.07981148182222744,0.07944872798026237,0.1053401525070854,0.06906158418903487,0.1033766276958818,0.08140514013284897,0.09743039749759362,0.1028203366017208,0.07395744454529703,0.08135482223803706,0.09039607428769303,0.1026244650611887,0.05866703712187642,0.08045513723116469,0.08666607201181863,0.1201760135215508,0.1923781918821798,0.2001247369104515,0.1192686018384274,0.214731520308921,0.2632680609070592,0.1828193582323299,0.1564554005040434,0.1465940994237572,0.2014962877384932,0.1781786797452144,0.1804182275712153,0.1608525620797872,0.1785920718708744,0.143605891566391,0.1825195062075425,0.1725176504839353,0.2177400269581863,0.1508830946351112,0.1941923953364066,0.2902808310434118,0.2559059060387711,0.2281105906463511,0.2707480298411737,0.2449912805205353,0.2157542220583945,0.2590405235525691,0.2538080486056694,0.2520550267842179,0.2740654836965434,0.2914085996377747,0.2372879509815879,0.2051154937081627,0.1707633766152462,0.1801789150383681,0.2765590034140728,0.1597343624246182,0.1987411169564653,0.2435627261056918,0.3273841075701107,0.3214499599534585,0.3576614381491071,0.3727826786330105,0.4088801493656094,0.3848750611474219,0.3659545936950905,0.3331626100272857,0.3340960092104807,0.28211960886615,0.3525704767929497,0.3592979892833655,0.3179402973435477,0.3618523538156778,0.2843937177118798,0.3129064018387064,0.3206866986839489,0.2856755210869457,0.3217844187921892,0.318892667179737,0.3483923904462507,0.5027758273755456,0.5711443303413245,0.6401979174823083,0.6150350057756839,0.5256181058214492,0.4238129608352063,0.5364664170231646,0.6452267863480746,0.5451936189419747,0.5485923325966486,0.4218065561501901,0.5818443072293131,0.5681871740611149,0.4867897317558055,0.4771954329977921,0.5747800091628609,0.459857659948352,0.5179711280653687,0.6331685805351467,0.4636530545082724,0.4994058543483749,0.5221302776818455,0.5649015986371537,0.5309873072075142,0.5226242973708402,0.5741035451177382,0.6422411612634954,0.5878411359020996,0.5474981323849248,0.6180707858487936,0.60551599652374,0.4946410576864543,0.5617166105154723,0.5969772543541357,0.5447306141135726,0.6062722007652045,0.56163825394796,0.4939741972326098,0.5201175917241592,0.6102977894353571],[0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95,0.95],[-280.9054194449716,-309.0889056840467,-309.3626354722134,-292.6275721471362,-283.238668590492,-238.3025283120334,-256.1677874453997,-320.8558873631584,-226.1960138737388,-289.3297924301569,-267.0631133291241,-310.5241030346077,-318.1343289055093,-229.0082450406919,-254.0672742000343,-303.0677820020587,-310.188598600827,-189.6347022436113,-246.0158754884156,-289.5069111452286,-325.6106381061106,-456.9327651367526,-449.6723353627082,-363.3080557097599,-506.1698561604068,-477.4961107612041,-419.6480894385186,-398.1878661153357,-335.7494464401765,-456.3593624961496,-422.932903846534,-441.8637838095473,-352.8559449274834,-394.2775878186848,-314.0356069523345,-425.8032361768706,-417.5798414132814,-479.5620746911627,-406.8253256856575,-444.9490701598421,-483.0229474654577,-526.0517063407663,-466.8803960809703,-515.5927296070741,-483.4515622847732,-455.7644830252027,-515.3846069911289,-511.2547636584899,-514.9638449734414,-510.7952910809533,-524.5661239132512,-462.2172788102567,-458.2216404178985,-399.9684927432457,-398.1734903494309,-509.7892120657901,-377.6521928482422,-440.5930657623452,-484.12212989516,-621.2940198072818,-585.7197955775014,-575.2598309285218,-595.4619892185417,-649.2833688847307,-608.0937031290102,-593.4491953678876,-585.1468556492814,-600.308215278064,-530.2732009160685,-555.5962220692761,-598.3837173570726,-557.449972733961,-595.9737693241277,-492.3985503239592,-573.816192756373,-539.1849503331334,-499.9635772367892,-578.9492649992058,-548.8327252061229,-618.1470016269149,-621.2626098068503,-620.925457468667,-667.4822197725616,-663.0307170339294,-606.6339206086587,-539.2343436578776,-613.9383273686033,-643.6584032020442,-655.7654438638401,-604.382211320042,-583.1182378401957,-619.0414521054305,-656.999198815665,-603.0212134873991,-614.0797074500147,-626.8017050317173,-588.9420702765142,-620.5928452321536,-689.41437953985,-574.7370304141441,-549.5569005951422,-598.1123622474486,-580.0325871194359,-619.7387305501071,-608.1097073546994,-606.9319980190545,-658.6760849026784,-600.3977662589308,-583.3054527588836,-661.8572361422891,-673.6244083675128,-576.6098816964366,-617.3711884800325,-663.4996482630984,-599.9380169941966,-635.2687988159636,-591.5659512446109,-576.1590840498974,-584.2857664632122,-614.4776162650171],[5,5,5,6,5,6,6,5,6,5,5,5,5,6,6,5,5,6,7,5,3,5,5,3,5,6,5,4,3,5,4,4,4,4,3,4,4,5,5,5,6,6,5,6,6,5,6,6,6,6,6,5,5,3,4,6,4,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,6,5,5,5,5,6,5,5,5,5,5,5,5,5,5,5,6,6,5,5,5,5,5,5,6,5,5,5,5,5,5,5,5,6,5,5,5,5],["HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA","HlyE_IgG+HlyE_IgA"],["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Stratum<\/th>\n      <th>lambda.sim<\/th>\n      <th>cluster<\/th>\n      <th>n<\/th>\n      <th>est.start<\/th>\n      <th>incidence.rate<\/th>\n      <th>SE<\/th>\n      <th>CI.lwr<\/th>\n      <th>CI.upr<\/th>\n      <th>coverage<\/th>\n      <th>log.lik<\/th>\n      <th>iterations<\/th>\n      <th>antigen.isos<\/th>\n      <th>nlm.convergence.code<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Stratum","targets":1},{"name":"lambda.sim","targets":2},{"name":"cluster","targets":3},{"name":"n","targets":4},{"name":"est.start","targets":5},{"name":"incidence.rate","targets":6},{"name":"SE","targets":7},{"name":"CI.lwr","targets":8},{"name":"CI.upr","targets":9},{"name":"coverage","targets":10},{"name":"log.lik","targets":11},{"name":"iterations","targets":12},{"name":"antigen.isos","targets":13},{"name":"nlm.convergence.code","targets":14}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render"],"jsHooks":[]}</script>
</div>
</div>
<p>We can plot the likelihood for a single simulated cluster by subsetting that simulation in <code>ests</code> and calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">ests</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also plot log-likelihood curves for several clusters at once (your computer might struggle to plot many at once):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">ests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/plot-multiple-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>log_x</code> argument also works here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">ests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, log_x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/plot-multiple-log-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<section class="level3"><h4 id="nlm-convergence-codes">
<code>nlm()</code> convergence codes<a class="anchor" aria-label="anchor" href="#nlm-convergence-codes"></a>
</h4>
<p>Make sure to check the <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm()</a></code> exit codes (codes 3-5 indicate possible non-convergence):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ests_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># removes extra meta-data</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Stratum</span>, <span class="va">nlm.convergence.code</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nlm.convergence.code</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 0 × 2</span></span>
<span><span class="co">#&gt; # ℹ 2 variables: Stratum &lt;chr&gt;, nlm.convergence.code &lt;ord&gt;</span></span></code></pre></div>
</div>
<p>Solutions to <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm()</a></code> exit codes 3-5:</p>
<ul>
<li>3: decrease the <code>stepmin</code> argument to <code><a href="../reference/est.incidence.html">est.incidence()</a></code>/<code><a href="../reference/est.incidence.by.html">est.incidence.by()</a></code>
</li>
<li>4: increase the <code>iterlim</code> argument to <code><a href="../reference/est.incidence.html">est.incidence()</a></code>/<code><a href="../reference/est.incidence.by.html">est.incidence.by()</a></code>
</li>
<li>5: increase the <code>stepmax</code> argument to <code><a href="../reference/est.incidence.html">est.incidence()</a></code>/<code><a href="../reference/est.incidence.by.html">est.incidence.by()</a></code>
</li>
</ul>
<p>We can extract the indices of problematic strata, if there are any:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">problem_strata</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ests_summary</span><span class="op">$</span><span class="va">nlm.convergence.code</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; integer(0)</span></span></code></pre></div>
</div>
<p>If any clusters had problems, we can take a look:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">problem_strata</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">ests</span><span class="op">[</span><span class="va">problem_strata</span><span class="op">]</span>, log_x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>If any of the fits don’t appear to be at the maximum likelihood, we should re-run those clusters, adjusting the <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm()</a></code> settings appropriately, to be sure.</p>
</section></section><section class="level2"><h3 id="plot-distribution-of-estimates-by-simulated-incidence-rate">plot distribution of estimates by simulated incidence rate<a class="anchor" aria-label="anchor" href="#plot-distribution-of-estimates-by-simulated-incidence-rate"></a>
</h3>
<p>Finally, we can look at our simulation results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">ests_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="st">"lambda.sim"</span>, </span>
<span>           CI <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>           dodge_width <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"data-generating incidence rate"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/graph-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="effect-of-renew_params">Effect of <code>renew_params</code>
<a class="anchor" aria-label="anchor" href="#effect-of-renew_params"></a>
</h3>
<p>Setting <code>renew_params = TRUE</code> is more realistic, but not is accounted for by the current method; for population samples from populations with high incidence rates, there may be bias:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_df_renew</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/sim_pop_data_multi.html">sim_pop_data_multi</a></span><span class="op">(</span></span>
<span>    sim_function <span class="op">=</span> <span class="va">sim_pop_data_2</span>,</span>
<span>    n_cores <span class="op">=</span> <span class="va">n_cores</span>,</span>
<span>    lambdas <span class="op">=</span> <span class="va">lambdas</span>,</span>
<span>    nclus <span class="op">=</span> <span class="va">nclus</span>,</span>
<span>    n_samples <span class="op">=</span> <span class="va">nrep</span>,</span>
<span>    age_range <span class="op">=</span> <span class="va">lifespan</span>,</span>
<span>    antigen_isos <span class="op">=</span> <span class="va">antibodies</span>,</span>
<span>    renew_params <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    add_noise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>    noise_limits <span class="op">=</span> <span class="va">dlims</span>,</span>
<span>    format <span class="op">=</span> <span class="st">"long"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">ests_renew</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/est.incidence.by.html">est.incidence.by</a></span><span class="op">(</span></span>
<span>    pop_data <span class="op">=</span> <span class="va">sim_df_renew</span>,</span>
<span>    curve_params <span class="op">=</span> <span class="va">dmcmc</span>,</span>
<span>    noise_params <span class="op">=</span> <span class="va">cond</span>,</span>
<span>    num_cores <span class="op">=</span> <span class="va">n_cores</span>,</span>
<span>    strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lambda.sim"</span>, <span class="st">"cluster"</span><span class="op">)</span>,</span>
<span>    curve_strata_varnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    noise_strata_varnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    verbose <span class="op">=</span> <span class="va">verbose</span>,</span>
<span>    build_graph <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># slows down the function substantially</span></span>
<span>    antigen_isos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HlyE_IgG"</span>, <span class="st">"HlyE_IgA"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">ests_renew_summary</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">ests_renew</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ests_renew_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="st">"lambda.sim"</span>,</span>
<span>           CI <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>           dodge_width <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"data-generating incidence rate"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="simulate_xsectionalData_files/figure-html/graph_renew-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Peter Teunis, Kristina Lai, Chris Orwa, Kristen Aiemjoy, Douglas Ezra Morrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
